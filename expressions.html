<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Expression tests</title>
	<link rel="stylesheet" href="../dist/mavo.css" />
	<link rel="stylesheet" href="style.css" />
	<style>
		[data-foo]::before {
			content: "[data-foo=" attr(data-foo) "]";
			background: #efc;
		}
	</style>
</head>
<body>

<h1>Expression tests</h1>

<script type="application/json" id="countries">{
	"country": [
		{
			"code": "",
			"name": "Online"
		},
		{
			"code": "us",
			"name": "United States"
		},
		{
			"code": "gb",
			"name": "United Kingdom"
		}
	]
}</script>

<section data-mavo="basicexpr">
	<h2>Basic</h2>

	<p>First column must be the same as the second.</p>

	<table>
		<tr>
			<td property="prop1">[40 + 2]</td>
			<td>42</td>
		</tr>
		<tr>
			<td>[40 +]</td>
			<td>40 +</td>
		</tr>
		<tr>
			<td><input value="[39 + 3]"></td>
			<td><input value="42"></td>
		</tr>
		<tr>
			<td property="prop2">[prop1 + 1]</td>
			<td>43</td>
		</tr>
		<tr>
			<td property="prop3">[prop2 + 1]</td>
			<td>44</td>
		</tr>
		<tr>
			<td>[prop3 + 1]</td>
			<td>45</td>
		</tr>
	</table>

</section>

<section data-store="#countries">
	<h2>With render (country data)</h2>

	<p>First column must be the same as the second.</p>

	<table>
		<tr>
			<td>[count(country)]</td>
			<td>3</td>
		</tr>
		<tr>
			<td>[count(code)]</td>
			<td>2</td>
		</tr>
		<tr>
			<td>
				<ul>
					<li property="country" data-multiple>
						<span property="code"></span> [code]
						<span property="name"></span> [name]
					</li>
				</ul>
			</td>
			<td>
				<ul>
					<li>Online Online</li>
					<li>usus United States UnitedStates</li>
					<li>gbgb United Kingdom United Kingdom</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>[country]</td>
			<td data-expressions="none">[object Object], [object Object], [object Object]</td>
		</tr>
		<tr>
			<td>[count(code == us)]</td>
			<td>1</td>
		</tr>
	</table>
</section>

<section class="mavo">
	<h2>Without render</h2>
	<p>First column must be the same as the second.</p>

	<table>
		<tr>
			<td>
				<ul>
					<li property="country" data-multiple>
						<span property="code">Code</span> [code]
						<span property="name">Name</span> [name]
					</li>
				</ul>
			</td>
			<td>
				<ul>
					<li>Code Code Name Name</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>[country]</td>
			<td data-expressions="none">[object Object]</td>
		</tr>
		<tr>
			<td>[count(code)]</td>
			<td>1</td>
		</tr>
	</table>
</section>

<section class="mavo mv-keep-unhandled" data-source="#countries">
	<h1>Broad references</h1>

	<select>
		<option value="[code]" property="country" data-multiple typeof>[name]</option>
	</select>
</section>

<section class="mavo" data-source="#countries">
	<h1>Custom expression syntax</h1>

	<p>All of the following should be green. There should be no red.</p>

	<ul>
		<li style="background: hsl([40 + 40], 100%, 50%)">Normal
			<div style="background: red; background: hsl([40 + 40], 100%, 45%)">Inner with the same syntax</div>
			<div style="background: red; background: hsl([[40 + 40]], 100%, 45%)" data-expressions="[[ ]]">Inner with different syntax</div>
		</li>
		<li data-expressions="{{ }}" style="background: hsl({{40 + 40}}, 100%, 50%)">Double brace</li>
		<li data-expressions="[[ ]]" style="background: hsl([[40 + 40]], 100%, 50%)">Double bracket
			<div style="background: red; background: hsl([[40 + 40]], 100%, 45%)">Inner with the same syntax</div>
			<div data-expressions="[ ]" style="background: red; background: hsl([40 + 40], 100%, 45%)">Inner with different syntax</div>
		</li>
		<li data-expressions="none" style="background: yellowgreen; background: hsl([40 - 40], 100%, 50%)">Escape expressions (data-expressions="none")</li>
		<li data-expressions=" " style="background: yellowgreen; background: hsl([40 - 40], 100%, 50%)">No delimiter (data-expressions=" "), should escape
			<div style="background: yellowgreen; background: hsl([40 - 40], 100%, 50%)">Inner with the same syntax</div>
		</li>
	</ul>
</section>

<section class="mavo">
	<h1>data-content</h1>

	<p>First column must be the same as the second.</p>

	<table>
		<tr>
			<td><div data-content="39 + 3">Without expression syntax</div></td>
			<td>42</td>
		</tr>
		<tr>
			<td><div data-content="(39 + 3">With bug</div></td>
			<td>With bug</td>
		</tr>
		<tr>
			<td><input data-content="39 + 3" value="In attribute"></td>
			<td><input value="42"></td>
		</tr>
	</table>
</section>

<script src="../dist/mavo.js"></script>

</body>
</html>
